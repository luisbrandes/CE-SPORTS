{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/web/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\r\nimport type { NextRequest } from \"next/server\"\r\n\r\nexport async function middleware(req: NextRequest) {\r\n  const sessionCookie = req.cookies.get(\"JSESSIONID\")\r\n  const url = req.nextUrl.clone()\r\n\r\n\r\n  if (!sessionCookie && (url.pathname.startsWith(\"/admin\") || url.pathname.startsWith(\"/aluno\"))) {\r\n    url.pathname = \"/login\"\r\n    return NextResponse.redirect(url)\r\n  }\r\n\r\n\r\n  if (sessionCookie) {\r\n    try {\r\n      const res = await fetch(\"http://localhost:8080/api/auth/me\", {\r\n        headers: { Cookie: `JSESSIONID=${sessionCookie.value}` },\r\n        credentials: \"include\",\r\n      })\r\n\r\n      if (res.status !== 200) {\r\n        url.pathname = \"/login\"\r\n        return NextResponse.redirect(url)\r\n      }\r\n\r\n      const data = await res.json()\r\n      const role = data.user?.role\r\n\r\n      if (url.pathname.startsWith(\"/admin\") && role !== \"ROLE_ADMIN\") {\r\n        url.pathname = \"/403\"\r\n        return NextResponse.redirect(url)\r\n      }\r\n\r\n      if (url.pathname.startsWith(\"/aluno\") && role !== \"ROLE_USER\") {\r\n        url.pathname = \"/403\"\r\n        return NextResponse.redirect(url)\r\n      }\r\n    } catch (e) {\r\n      console.error(\"Erro no middleware:\", e)\r\n    }\r\n  }\r\n\r\n  return NextResponse.next()\r\n}\r\n\r\nexport const config = {\r\n  matcher: [\"/admin/:path*\", \"/aluno/:path*\"],\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAGO,eAAe,WAAW,GAAgB;IAC/C,MAAM,gBAAgB,IAAI,OAAO,CAAC,GAAG,CAAC;IACtC,MAAM,MAAM,IAAI,OAAO,CAAC,KAAK;IAG7B,IAAI,CAAC,iBAAiB,CAAC,IAAI,QAAQ,CAAC,UAAU,CAAC,aAAa,IAAI,QAAQ,CAAC,UAAU,CAAC,SAAS,GAAG;QAC9F,IAAI,QAAQ,GAAG;QACf,OAAO,uMAAY,CAAC,QAAQ,CAAC;IAC/B;IAGA,IAAI,eAAe;QACjB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,qCAAqC;gBAC3D,SAAS;oBAAE,QAAQ,CAAC,WAAW,EAAE,cAAc,KAAK,EAAE;gBAAC;gBACvD,aAAa;YACf;YAEA,IAAI,IAAI,MAAM,KAAK,KAAK;gBACtB,IAAI,QAAQ,GAAG;gBACf,OAAO,uMAAY,CAAC,QAAQ,CAAC;YAC/B;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,MAAM,OAAO,KAAK,IAAI,EAAE;YAExB,IAAI,IAAI,QAAQ,CAAC,UAAU,CAAC,aAAa,SAAS,cAAc;gBAC9D,IAAI,QAAQ,GAAG;gBACf,OAAO,uMAAY,CAAC,QAAQ,CAAC;YAC/B;YAEA,IAAI,IAAI,QAAQ,CAAC,UAAU,CAAC,aAAa,SAAS,aAAa;gBAC7D,IAAI,QAAQ,GAAG;gBACf,OAAO,uMAAY,CAAC,QAAQ,CAAC;YAC/B;QACF,EAAE,OAAO,GAAG;YACV,QAAQ,KAAK,CAAC,uBAAuB;QACvC;IACF;IAEA,OAAO,uMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAiB;KAAgB;AAC7C"}}]
}