{"version":3,"sources":["turbopack:///[project]/components/ui/card.tsx","turbopack:///[project]/app/(admin)/admin/campeonatos/historico-partidas/page.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport function Card({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\r\n  return (\r\n    <div\r\n      className={cn(\r\n        \"rounded-xl border border-border bg-card p-4 shadow-sm transition hover:shadow-md\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n","\"use client\";\r\n\r\nimport { useEffect, useState, useMemo } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\n\r\ntype ApiEquipe = {\r\n  id?: number;\r\n  nome?: string;\r\n};\r\n\r\ntype ApiCampeonato = {\r\n  id?: number;\r\n  nome?: string;\r\n};\r\n\r\ntype ApiPartidaRaw = {\r\n  id?: number;\r\n  campeonato?: ApiCampeonato | string;\r\n  equipe1?: ApiEquipe | string;\r\n  equipe2?: ApiEquipe | string;\r\n  pontuacao1?: number | string | null;\r\n  pontuacao2?: number | string | null;\r\n  empate?: boolean;\r\n  vencedor?: ApiEquipe | string | null;\r\n  data?: string | null;\r\n};\r\n\r\nexport default function PartidasPage() {\r\n  const [partidas, setPartidas] = useState<ApiPartidaRaw[] | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const normalizeName = (\r\n    value: ApiEquipe | ApiCampeonato | string | undefined | null\r\n  ) => {\r\n    if (!value) return \"-\";\r\n    if (typeof value === \"string\") return value;\r\n    return (value as any).nome ?? \"-\";\r\n  };\r\n\r\n  const normalizeScore = (\r\n    val: number | string | undefined | null\r\n  ): number | null => {\r\n    if (val === null || val === undefined) return null;\r\n    if (typeof val === \"number\") return val;\r\n    const n = Number(val);\r\n    return Number.isNaN(n) ? null : n;\r\n  };\r\n\r\n  const fetchPartidas = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    setPartidas(null);\r\n    const candidates = [\"/api/partida\"];\r\n    let lastError: any = null;\r\n\r\n    for (const url of candidates) {\r\n      try {\r\n        const res = await fetch(\"http://localhost:8080/api/partida\", {\r\n          method: \"GET\",\r\n          cache: \"no-store\",\r\n          credentials: \"include\",\r\n        });\r\n        if (!res.ok) {\r\n          lastError = `endpoint ${url} retornou ${res.status}`;\r\n          continue;\r\n        }\r\n        const json = await res.json();\r\n        const arr = Array.isArray(json)\r\n          ? json\r\n          : json?.data ?? json?.content ?? json?.partidas ?? null;\r\n        if (!arr || !Array.isArray(arr)) {\r\n          lastError = `endpoint ${url} retornou formato inesperado`;\r\n          continue;\r\n        }\r\n        const normalized = arr.map((p: ApiPartidaRaw) => ({\r\n          ...p,\r\n          pontuacao1: normalizeScore(p.pontuacao1 as any),\r\n          pontuacao2: normalizeScore(p.pontuacao2 as any),\r\n        }));\r\n        setPartidas(normalized);\r\n        setLoading(false);\r\n        return;\r\n      } catch (e) {\r\n        lastError = e;\r\n      }\r\n    }\r\n\r\n    setLoading(false);\r\n    setError(\r\n      `Não foi possível obter partidas: ${\r\n        typeof lastError === \"string\"\r\n          ? lastError\r\n          : (lastError && lastError.message) || \"erro desconhecido\"\r\n      }. Verifique o endpoint da API.`\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchPartidas();\r\n  }, []);\r\n\r\n  const sortedPartidas = useMemo(() => {\r\n    if (!partidas) return null;\r\n    return [...partidas].sort((a, b) => {\r\n      const aDate = a.data ? Date.parse(a.data) : NaN;\r\n      const bDate = b.data ? Date.parse(b.data) : NaN;\r\n      if (!Number.isNaN(aDate) && !Number.isNaN(bDate)) return bDate - aDate;\r\n      if (!Number.isNaN(aDate)) return -1;\r\n      if (!Number.isNaN(bDate)) return 1;\r\n      const aId = a.id ?? 0;\r\n      const bId = b.id ?? 0;\r\n      return bId - aId;\r\n    });\r\n  }, [partidas]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background text-foreground py-8\">\r\n      <div className=\"container mx-auto px-4\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-black\">\r\n              Histórico de Partidas\r\n            </h1>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-3\">\r\n            <Link href=\"/admin/campeonatos\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                className=\"border-blue-600 text-blue-600 hover:bg-blue-50\"\r\n              >\r\n                ← Voltar para Campeonatos\r\n              </Button>\r\n            </Link>\r\n\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => {\r\n                fetchPartidas();\r\n              }}\r\n            >\r\n              Refresh\r\n            </Button>\r\n\r\n            <Link href=\"/admin/campeonatos/registrar-partida\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                className=\"border-blue-600 text-blue-600 hover:bg-blue-50 px-5\"\r\n              >\r\n                ➕ Nova Partida\r\n              </Button>\r\n            </Link>\r\n          </div>\r\n        </div>\r\n\r\n        <Card className=\"p-4\">\r\n          {loading && (\r\n            <div className=\"py-8 text-center\">Carregando partidas...</div>\r\n          )}\r\n\r\n          {!loading && error && (\r\n            <div className=\"py-6\">\r\n              <div className=\"text-red-600 mb-2\">Erro: {error}</div>\r\n              <div className=\"text-sm text-muted-foreground mb-4\">\r\n                Se a API não estiver pronta, você pode usar dados mock:\r\n              </div>\r\n              <div className=\"flex gap-2\">\r\n                <Button variant=\"outline\" onClick={() => fetchPartidas()}>\r\n                  Tentar novamente\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {!loading && sortedPartidas && sortedPartidas.length === 0 && (\r\n            <div className=\"py-8 text-center text-muted-foreground\">\r\n              Nenhuma partida encontrada.\r\n            </div>\r\n          )}\r\n\r\n          {!loading && sortedPartidas && sortedPartidas.length > 0 && (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"min-w-full text-sm\">\r\n                <thead className=\"bg-blue-600 text-white\">\r\n                  <tr>\r\n                    <th className=\"p-2 text-left\">Campeonato</th>\r\n                    <th className=\"p-2 text-left\">Equipe 1</th>\r\n                    <th className=\"p-2 text-left\">Equipe 2</th>\r\n                    <th className=\"p-2 text-left\">Placar</th>\r\n                    <th className=\"p-2 text-left\">Resultado</th>\r\n                    <th className=\"p-2 text-left\">Data</th>\r\n                  </tr>\r\n                </thead>\r\n\r\n                <tbody>\r\n                  {sortedPartidas.map((p, idx) => {\r\n                    const camp = normalizeName(p.campeonato);\r\n                    const e1 = normalizeName(p.equipe1);\r\n                    const e2 = normalizeName(p.equipe2);\r\n                    const g1 = p.pontuacao1 ?? null;\r\n                    const g2 = p.pontuacao2 ?? null;\r\n\r\n                    const left = g1 === null ? \"-\" : String(g1);\r\n                    const right = g2 === null ? \"-\" : String(g2);\r\n                    const placarDisplay =\r\n                      g1 === null && g2 === null\r\n                        ? \"Pendente\"\r\n                        : `${left} × ${right}`;\r\n\r\n                    let resultado = \"-\";\r\n                    if (p.empate) resultado = \"Empate\";\r\n                    else if (p.vencedor) resultado = normalizeName(p.vencedor);\r\n                    else if (typeof g1 === \"number\" && typeof g2 === \"number\") {\r\n                      if (g1 > g2) resultado = e1;\r\n                      else if (g2 > g1) resultado = e2;\r\n                      else resultado = \"—\";\r\n                    }\r\n\r\n                    const dataStr = p.data\r\n                      ? new Date(p.data).toLocaleString(\"pt-BR\")\r\n                      : \"-\";\r\n\r\n                    return (\r\n                      <tr\r\n                        key={p.id ?? idx}\r\n                        className=\"border-t border-border hover:bg-muted/30 transition\"\r\n                      >\r\n                        <td className=\"p-2 text-black\">{camp}</td>\r\n                        <td className=\"p-2\">{e1}</td>\r\n                        <td className=\"p-2\">{e2}</td>\r\n                        <td className=\"p-2 font-medium\">{placarDisplay}</td>\r\n                        <td className=\"p-2\">{resultado}</td>\r\n                        <td className=\"p-2\">{dataStr}</td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}